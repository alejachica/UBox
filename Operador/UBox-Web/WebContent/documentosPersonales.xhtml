<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="/templates/template-prueba.xhtml">
	<ui:define name="bodyContent">
		<!--div class="row"-->
			<!--div class="box col-md-12"-->
				<!--div class="box-inner"-->
					<div class="box-header well" data-original-title="">
					    <h2><i class="glyphicon glyphicon-user"></i>Directorio documentos</h2>
					</div>
					<!--div class="box-content"-->
						<div class="alert alert-info">
						    <table class="table">
						        <tbody>
						            <tr>
						                <td>
						                    <p:commandLink onclick="PF('dialogoCrearCarpeta').show();" value="Crear Carpeta">
						            		</p:commandLink>
						                </td>
						            </tr>
						        </tbody>
						    </table>
						</div>
						<h:form id="formDirectorioId">
						    <p:treeTable value="#{directorioBean.root}" var="carpeta" id="directorio">
						        <f:facet name="header">
						            Directorio
						        </f:facet>
						        <p:column headerText="Tipo">
						            <h:outputText styleClass="ui-icon ui-icon-folder-collapsed" rendered="#{carpeta.type eq 'Folder'}"/>
						            <h:outputText styleClass="ui-icon ui-icon-document" rendered="#{carpeta.type eq 'Archivo'}"/>
						        </p:column>
						        <p:column headerText="Nombre">
						            <h:outputText value="#{carpeta.nombre}"/>
						        </p:column>
						        <p:column headerText="Descripcion">
						            <h:outputText value="#{carpeta.descripcion}" />
						        </p:column>
							    <p:column headerText="Acciones">
							    	<!-- Manejo de carpetas -->
							    	<p:commandLink title="Cargar Documento" onclick="PF('dialogoCargarDoc').show();" styleClass="ui-icon ui-icon-circle-arrow-n"  rendered="#{carpeta.type eq 'Folder'}">
							    		<f:setPropertyActionListener value="#{carpeta.id}" target="#{directorioBean.carpetaId}"/>
						            </p:commandLink>
							    	<p:commandLink title="Crear Sub-Carpeta" onclick="PF('dialogoCrearCarpeta').show();" styleClass="ui-icon ui-icon-plus" rendered="#{carpeta.type eq 'Folder'}">
						            </p:commandLink>
						            <p:commandLink oncomplete="PF('dialogoElimCarpeta').show();" title="Eliminar Carpeta" styleClass="ui-icon ui-icon-trash" rendered="#{carpeta.type eq 'Folder'}">
						                <f:setPropertyActionListener value="#{carpeta.id}" target="#{directorioBean.carpetaId}"/>
						            </p:commandLink>
						        	<!-- Manejo de documentos -->
				                    <p:commandLink title="Descargar Documento" onclick="PF('dialogoDescargarDoc').show();" styleClass="ui-icon ui-icon-circle-arrow-s" rendered="#{carpeta.type eq 'Archivo'}">
				                    	<f:setPropertyActionListener value="#{carpeta.id}" target="#{directorioBean.documentoId}"/>
				                    	<!--p:fileDownload value="#{directorioBean.fileDown}"></p:fileDownload-->
						            </p:commandLink>
							    	<p:commandLink title="Compartir Documento" styleClass="ui-icon ui-icon-person" rendered="#{carpeta.type eq 'Archivo'}">
						            </p:commandLink>
						            <p:commandLink title="Eliminar Documento" oncomplete="PF('dialogoDoc').show();" styleClass="ui-icon ui-icon-trash" rendered="#{carpeta.type eq 'Archivo'}">
						            	<f:setPropertyActionListener value="#{carpeta.id}" target="#{directorioBean.documentoId}"/>
						            </p:commandLink>
					        	</p:column>
						    </p:treeTable>
					 	</h:form>
					 	
					 	<h:form enctype="multipart/form-data" id="formDialog">
						 	<!-- Dialogo para crear una carpeta -->
						 	<p:dialog id="dialogoCrearCarpetaId" header="Crear Carpeta" showEffect="fade" widgetVar="dialogoCrearCarpeta" modal="true" resizable="false">
						 		<table>
						 			<tr>
						 				<td><h:outputText value="Nombre: "></h:outputText></td>
						 				<td><h:inputText value="#{directorioBean.nombre}"></h:inputText></td>
						 			</tr>
						 			<tr>
						 				<td><h:outputText  value="Descripcion: "></h:outputText></td>
						 				<td><h:inputText value="#{directorioBean.descripcion}"></h:inputText></td>
						 			</tr>
						 		</table>
								<br/>
						     	<h:commandButton action="#{directorioBean.crearCarpeta}" value="Crear Carpeta" update=":formDirectorioId:directorio">
								</h:commandButton>
						    </p:dialog>
						    <!-- Dialogo para eliminar una carpeta -->
						    <p:dialog id="dialogoElimCarpetaId" header="Eliminar Carpeta" showEffect="fade" widgetVar="dialogoElimCarpeta" modal="true" resizable="false">
						 		<td><h:outputText value="Esta seguro de eliminar esta carpeta?"></h:outputText></td>
								<br/>
								<table>
									<tr>
										<td><h:commandButton action="PF('dialogoElimCarpeta').hide();" value="NO"></h:commandButton></td>
										<td><h:commandButton action="#{directorioBean.eliminarCarpeta}" value="SI"></h:commandButton></td>
									</tr>
								</table>
						    </p:dialog>
						    <!-- Dialogo para cargar documento -->
						    <p:dialog id="dialogoCargarDocId" header="Cargar documento" showEffect="fade" widgetVar="dialogoCargarDoc" modal="true" resizable="false" width="600" height="100">
						    	<table>
						    		<tr>
							    	<td><p:fileUpload value="#{directorioBean.file}" mode="simple" skinSimple="true"/></td>
			    					</tr>
			    					<tr>
			    					<td><p:commandButton value="Cargar" ajax="false" actionListener="#{directorioBean.upload}"/></td>
			    					</tr>
						    	</table>
						    </p:dialog>
						    <!-- Dialogo para eliminar una documento -->
						    <p:dialog id="dialogoElimDocId" header="Eliminar Documento" showEffect="fade" widgetVar="dialogoDoc" modal="true" resizable="false">
						 		<td><h:outputText value="Esta seguro de eliminar este documento?"></h:outputText></td>
								<br/>
								<table>
									<tr>
										<td><h:commandButton action="PF('dialogoDoc').hide();" value="NO"></h:commandButton></td>
										<td><h:commandButton action="#{directorioBean.eliminarDocumento}" value="SI"></h:commandButton></td>
									</tr>
								</table>
						    </p:dialog>
						    <!-- Dialogo para descargar una documento -->
						    <p:dialog id="dialogoDescargarDocId" header="Desgargar Documento" showEffect="fade" widgetVar="dialogoDescargarDoc" modal="true" resizable="false">
						 		<td><h:outputText value="Esta seguro que desea descargar este documento?"></h:outputText></td>
								<br/>
								<table>
									<tr>
										<td><h:commandButton action="PF('dialogoDescargarDoc').hide();" value="NO"></h:commandButton></td>
										<td><h:commandButton action="#{directorioBean.downLoad}" onclick="PF('dialogoDescargarDoc').hide();" value="SI"></h:commandButton></td>
									</tr>
								</table>
						    </p:dialog>
					    </h:form>
					<!--/div-->
				<!--/div-->
			<!--/div-->
	    <!--/div-->
	</ui:define>
</ui:composition>